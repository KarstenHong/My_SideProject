<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>筆記整合系統</title>
    <link rel="stylesheet" href="NoteRecord.css">
    <!-- 匯出功能所需的庫 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.42.3/docxtemplater.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pizzip/3.1.4/pizzip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pizzip/3.1.4/pizzip-utils.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>📝 筆記整合系統</h1>
            <p>快速整理您的筆記，自動排版並匯出文件</p>
        </header>

        <!-- 統計面板 -->
        <div class="statistics-panel">
            <div class="stat-card">
                <h3>筆記總數</h3>
                <p class="stat-value" id="totalNotes">0</p>
            </div>
            <div class="stat-card">
                <h3>類別數量</h3>
                <p class="stat-value" id="totalCategories">0</p>
            </div>
            <div class="stat-card">
                <h3>最新更新</h3>
                <p class="stat-value" id="lastUpdate">-</p>
            </div>
        </div>

        <!-- 新增筆記區 -->
        <div class="form-section">
            <h2>新增筆記</h2>
            <form id="noteForm">
                <div class="form-group">
                    <label for="noteCategory">類別 *</label>
                    <div class="category-input-container">
                        <select id="noteCategory" required>
                            <option value="">請選擇或新增類別</option>
                            <option value="工作筆記">工作筆記</option>
                            <option value="學習筆記">學習筆記</option>
                            <option value="會議記錄">會議記錄</option>
                            <option value="專案規劃">專案規劃</option>
                            <option value="個人日記">個人日記</option>
                        </select>
                        <button type="button" class="btn-add-category" onclick="addNewCategory()">➕ 新增類別</button>
                    </div>
                </div>

                <div class="form-group">
                    <label for="noteTitle">標題 *</label>
                    <input type="text" id="noteTitle" placeholder="請輸入筆記標題" required>
                </div>

                <div class="form-group">
                    <label for="noteContent">內容 * 
                        <span style="color: #888; font-weight: normal; font-size: 0.9em;">
                            (系統將自動美化排版 - 支援 **粗體**、*斜體*、`代碼`、【重點】、引用、列表等格式)
                        </span>
                    </label>
                    <textarea id="noteContent" rows="10" placeholder="在此貼上或輸入文字，系統將自動美化排版...

支援的格式標記：
• **粗體文字** 或 *斜體文字*
• `代碼或專有名詞`
• 【重點標記】
• > 引用文字
• - 項目列表  
• 1. 數字列表
• --- 分隔線
• 網址會自動轉連結" required></textarea>
                </div>

                <div class="form-group">
                    <label for="noteTags">標籤</label>
                    <input type="text" id="noteTags" placeholder="用逗號分隔，例如：重要, 待辦, 提醒">
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn-primary">➕ 新增筆記</button>
                    <button type="button" class="btn-secondary" onclick="resetForm()">🔄 清除</button>
                </div>
            </form>
        </div>

        <!-- 筆記管理區 -->
        <div class="notes-section">
            <div class="section-header">
                <h2>筆記管理</h2>
                <div class="export-buttons">
                    <button class="btn-preview" onclick="previewDocument()">👁️ 預覽</button>
                    <button class="btn-export" onclick="exportToPDF()">📄 匯出 PDF</button>
                    <button class="btn-export" onclick="exportToWord()">📘 匯出 Word</button>
                </div>
            </div>

            <!-- 篩選工具列 -->
            <div class="filter-bar">
                <select id="categoryFilter" onchange="filterNotes()">
                    <option value="">所有類別</option>
                </select>
                <input type="text" id="searchInput" placeholder="搜尋標題、內容或標籤..." oninput="filterNotes()">
                <button onclick="clearFilters()">清除篩選</button>
            </div>

            <!-- 筆記列表 -->
            <div id="notesList" class="notes-list">
                <div class="no-notes">目前沒有筆記，請新增第一筆筆記</div>
            </div>
        </div>
    </div>

    <!-- 預覽 Modal -->
    <div id="previewModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closePreviewModal()">&times;</span>
            <h2>文件預覽</h2>
            <div id="previewContent" class="preview-content"></div>
            <div class="modal-actions">
                <button class="btn-primary" onclick="exportToPDF()">📄 匯出 PDF</button>
                <button class="btn-primary" onclick="exportToWord()">📘 匯出 Word</button>
                <button class="btn-secondary" onclick="closePreviewModal()">關閉</button>
            </div>
        </div>
    </div>

    <!-- 編輯筆記 Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditModal()">&times;</span>
            <h2>編輯筆記</h2>
            <div id="editFormContainer"></div>
        </div>
    </div>

    <!-- 自訂提示窗 -->
    <div id="customAlert" class="custom-alert-overlay">
        <div class="custom-alert-box">
            <div class="custom-alert-icon" id="alertIcon"></div>
            <div class="custom-alert-message" id="alertMessage"></div>
            <div class="custom-alert-buttons" id="alertButtons"></div>
        </div>
    </div>

    <script src="NoteRecord.js"></script>
</body>
</html>
